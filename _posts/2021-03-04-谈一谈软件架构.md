---
layout: post
title: 谈一谈软件架构
date: 2021-03-04 10:27
category: Software Engineering
author: 赵星汉
tags: softwareEngineering softwareArchitecture
summary: 
---


自己关于软件架构的一些思考。





* content
{:toc}


前段时间听丛斌博士的公开课，里边谈到了中国国内最缺的人才就是软件架构师。我们经常提到软件架构，但到底什么才是软件架构？软件架构和产品设计，需求分析和编码到底有什么关系？

## 软件为什么要有架构

我是在十几年前开始做第一个软件项目，用C++写的一个监控程序，规模大概在万行左右。由于刚出校门，程序虽然说运行无碍，但是内部的结构简直一团乱麻。在程序进场联试以后，上级提出了若干次更改，随着更改次数的增多，类型之间的互耦也越来越复杂，到最后只能对程序的大部分内容进行了重构（说难听点就是重新写了一个）。还好功能变更主要集中在几个软件上，系统的整体结构还没有到不得不变的程序，否则损失就太大了。

从那以后，我就开始逐渐重视程序的架构甚至是系统架构的总体设计。提前考虑变更风险，选择的技术方案尽量降低软硬件不同模块之间的耦合，各个子系统、子功能之间相对独立，尽量将通用的东西做成一个“中台”，让系统功能分解成一个个“微服务”。最终实践结果也证明了，小型松耦合的组件可以更轻易的构建、修改、删除、替换以及测试，降低变更成本，提升系统质量。

## 架构&设计

上面所说的，明显都是设计，那么软件架构和设计到底有什么关系？

大神Grady Booch是这样解释的：

“所有架构都是设计，但并非所有的设计都是架构”。

“架构反映了使一个系统成型的重要设计决策，而重要性则通过改变的成本来衡量”。

说的直白点，其实就是设计中的重要决策就是架构。

架构涉及的内容，可能会涵盖但不限于如下几个方面：

- 子系统/分系统的划分与实现方式
- 软件系统的结构
- 框架选择
- 设计方法与模式
- 软件生命周期模型的选择





## 架构师的职责

在常规的软件研发流程中，架构师应该做哪些工作？通过上边的分析，架构师的职责应该是贯穿产品生命周期的始终，它像一根绳子，串起来软件研发过程中的所有利益相关者，并需要参与软件产品设计的所有重要决策。所以，我们可以将架构师看成一个非常重要的软件总体角色，它是一种职责而不是职位，在软件设计相关的所有内容中，软件的架构是所有重要内容的集成，也就是软件中最重要的部分，没有之一。那么，根据权责一致性的理论，负责软件架构的人，也就是架构师，就是软件设计技术的第一责任人。大型的软件项目，由于项目规模大，涉众人数多，各方协调的职责很重，可以设置专职的架构师，甚至根据分工设置多个内容和不同层级的架构师，从而减轻软件总师或总架构师的压力；而中小型项目，架构师完全可以由软件总师兼任。

### 需求分析

*前段时间和一个朋友聊，他说他聘请了一个架构师，已经把软件架构设计完毕了，然后要了一笔钱，说下边应该找个专业的需求分析把需求分析做一做，然后找个编码团队把代码编一下就可以交付了。我听后就觉得我朋友被骗了。*

需求分析对于软件的重要性不言而喻，如今敏捷团队在项目实施过程中，之所以要求紧密的连接客户，在每一个冲刺完毕后就让客户对产品进行确认，目的其实也是为了保证自己理解的最终产品和客户需求是一致的。如今的互联网的APP为什么需要用户的反馈，为什么不停的迭代，目的之一也是为了自己的软件更加贴近用户的需求。即使在传统的瀑布流开发的模式中，需求分析也是软件开发流程中不可或缺的一步，有着严格的里程碑节点和评审机制，在很多软件企业中，需求分析是最终验收前的最后一次确认。所以说，需求分析不是不重要，而是太重要了。需求分析做的不对，或者不好，会导致团队期望中的产品与客户的需求产生偏差，交付的软件产品肯定达不到客户的预期。

架构师的职责中，需求分析绝对是要排在第一位的。架构师不仅要起到承上启下的作用，一方面要梳理利益相关者，和PO（产品经理，软总）一起梳理软件涉众，对需求进行梳理，并对需求按照重要性进行排序。而这一阶段，架构师也有很多工作，例如：需求重要性等级划分、风险分析与分级、根据现有人力和物力资源选择生命周期模型、和重要客户讨论一些关键功能和非功能性指标、系统的关键指标的在不同配置项上的分解、参与重要的风险分析与管理方法讨论等。

- 制定软件的愿景，即软件的总体价值在哪里，实现的主要目的，或解决了用户什么痛点；
- 在软硬结合的系统中，和系统总体一起研究软硬件构成、选型与接口；
- 和系统总体或相关客户一起商定重要的功能性指标和非功能性指标；
- 选择需求开发的技术方法，根据团队的特点选择利用文本条目、简图还是UML建模等方式；
- 根据系统和软件的特点，对软件的配置项进行分解，并对系统的


这些活动的完成才代表软件有了一个大致的轮廓，相当于软件生产进程迈出了第一步。架构师的工作，到这里才刚刚开始。




## 在安全关键软件领域，是否应该设置架构师

在安全关键领域，设置架构师这一职责，将其位置放在软件总师的位置之下或平级于软件总师，把项目中和通用技术（需求分析技术、软件分层设计、数据库设计等）相关的技术职责划给软件架构师，对项目的发展是有着非常大的好处的。

1. 有助于新技术的推广应用。现在大多数项目的软件总师，是所在项目核心领域的专家，但不一定是软件通用技术的专家。由于项目的软件总师一直忙于项目，大多数软件总师对于软件通用技术（如新的语言，设计模式，软件框架，云技术，大数据，人工智能等）都不是很熟悉。由于软件总师压力很大，即使很多一线的软件总师想去学一些新的东西，往往也是心有余而力不足。而计算机行业发展飞快，新技术层出不穷，以至于很多新的项目，明明有更好、更可靠的解决方案，但是软总由于不熟悉而不敢采纳。所以，设置软件架构师，负责通用技术，能够很好的补充原来项目组的不足。
2. 能够非常好的推进组织的公共资产库的使用。我们很多的组织资产库中的软件资产，得不到很好的利用，原因并不是一线的科研人员不想用，而是由于“部门墙”的存在，一线开发人员不清楚库里的有哪些东西可以利用，以及好不好用。而软件架构师，由于其研究范围主要集中于通用技术，其技术适用性广，人员在课题中的流动性强，因此架构师们受“部门墙”的影响相对较小，其眼界要比单纯从事某一业务板块的软件总师要广，更容易知道整个组织内有哪些资源可以借用。因此，在课题中设置架构师，是可以促进共用资产利用率的。
3. 能够解决纯软件人员的职业发展通道问题。目前一些领域和组织，软件人员如果仅仅将自己的能力放在提升软件的设计和编码能力上，发展的通道是受限的，而如果所有优秀的软件人员，都往软件总体方面发展，去做业务领域而逐渐疏离软件设计，也非常不利于组织整体技术能力的提升。而在课题中设立架构师的分工，能提供给在软件开发领域有所擅长的技术人员一个良好的上升通道。
4. 